<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Music Site</title>
<style>
body { font-family: Arial; background:#444; color:#eee; }
nav { display:flex; gap:10px; margin-bottom:20px; }
button { padding:8px 14px; background:#333; color:#fff; border:0; cursor:pointer; }
button:hover { background:#555; }
.section { display:none; }
#artist-tabs, #album-tabs { display:flex; gap:10px; margin:15px 0; flex-wrap:wrap; }
#track-list img { max-width:200px; margin:10px 0; display:block; }
.download-btn { margin-left:10px; color:#6cf; }
.track-name { font-weight:bold; margin-top:10px; }
</style>
</head>
<body>

<nav>
  <button onclick="showSection('welcome')">Welcome</button>
  <button onclick="showSection('music')">Music</button>
  <button onclick="showSection('community')">Community</button>
  <button onclick="showSection('terms-of-use')">Terms of Use</button>
</nav>

<div id="welcome" class="section" style="display:block;">
  <p>Welcome to our site, this is where Paraxial Nolar and Ranar, The Wrathful(Wrath of the Revenant) post their music and album art. <br>
    If you wish, you may navigate to the music tab and download them for free! <br>
    Please check out the Terms of Use tab if you plan on sharing the music/art in any form! <br>
    If you have any questions for us, please check out the Community tab. <br>
  Note: Files may take a moment to load.<br><br><br></p>
<!-- CHANGELOG START -->
<div class="changelog">
  <h2>Changelog</h2>

  <div class="log-entry">
    <h3>2025-12-05</h3>
    <ul>
      <li>Added the Changelog.</li>
      <li>Improved the quality of "Mindbreak" and "Dance of the Dusty Deviant" by Technological Disguise.</li>
      <li>Added "Originals" Tab in the music section, allowing you download some of the original work or at the very least be able to see and buy the originals of the songs.</li>
    </ul>
  </div>
</div>
<!-- CHANGELOG END -->

</div>

<div id="music" class="section">
  <h1>Music</h1>

  <div id="artist-tabs"></div>
  <div id="album-tabs"></div>

  <div id="track-list"></div>
</div>

<div id="community" class="section">
  <h1>Community</h1>
  <p>You may contact us at systemdecline89305@gmail.com or at our discord <a href="https://discord.gg/UaUFuyNmsz">server</a>.<br>
  Below are some links to some youtube channels for our music:</p>
  <a href="https://www.youtube.com/@WotR-Music" target="_blank">Wrath of the Revenant</a>
<a href="https://www.youtube.com/@Paraxial-u1c" target="_blank">Paraxial Nolar</a>
<a href="https://www.youtube.com/@technologicaldisguise" target="_blank">Technological Disguise</a>

</div>
  
<div id="terms-of-use" class="section">
  <h1>Terms of Use</h1>
  <p>All music, artwork, and related materials created by Paraxial Nolar, Wrath of the Revenant, and Technological Disguise are <br>free for anyone to use, modify, and distribute for non-commercial purposes.
<br>
Users must provide clear credit to the original creators when using or altering the material.<br>
Sharing any modifications, remixes, or uses of this material to us is not required but is greatly appreciated.<br>
  You can contact either of us using the data provided at the Community tab.</p>
</div>
  
<script>
function showSection(id) {
  document.querySelectorAll('.section').forEach(sec => sec.style.display = 'none');
  document.getElementById(id).style.display = 'block';
}

function populateArtists(data) {
  const wrap = document.getElementById('artist-tabs');
  wrap.innerHTML = '';
  Object.keys(data).forEach(name => {
    const b = document.createElement('button');
    b.textContent = name;
    b.onclick = () => populateAlbums(name, data[name]);
    wrap.appendChild(b);
  });
}

function populateAlbums(artist, albums) {
  const wrap = document.getElementById('album-tabs');
  wrap.innerHTML = '';
  document.getElementById('track-list').innerHTML = '';
  Object.keys(albums).forEach(name => {
    const b = document.createElement('button');
    b.textContent = name;
    b.onclick = () => populateTracks(artist, name, albums[name]);
    wrap.appendChild(b);
  });
}
function populateTracks(artist, album, files) {
  const wrap = document.getElementById('track-list');
  wrap.innerHTML = '';

  const artistSafe = encodeURIComponent(artist);
  const albumSafe = encodeURIComponent(album);

  files.forEach(f => {
    const div = document.createElement('div');

    let filename = null;
    let youtubeId = null;
    let title = null;

    // Detect object (YouTube item) vs string (normal file)
    if (typeof f === 'string') {
      filename = f;
      title = f;
    } else if (typeof f === 'object' && f.youtube) {
      title = f.title || 'YouTube Track';
      youtubeId = extractYouTubeId(f.youtube);
    }

    // Track title
    const name = document.createElement('div');
    name.className = 'track-name';
    name.textContent = title;
    div.appendChild(name);

    // If it's a YouTube item
    if (youtubeId) {
      const iframe = document.createElement('iframe');
      iframe.width = '560';
      iframe.height = '315';
      iframe.src = `https://www.youtube.com/embed/${youtubeId}`;
      iframe.frameBorder = '0';
      iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
      iframe.allowFullscreen = true;

      div.appendChild(iframe);
      wrap.appendChild(div);
      return;
    }

    // Continue with your original file handling
    const lower = filename.toLowerCase();
    const fileSafe = encodeURIComponent(filename);
    const path = `${artistSafe}/${albumSafe}/${fileSafe}`;

    if (lower.endsWith('.mp3') || lower.endsWith('.wav') || lower.endsWith('.ogg')) {
      const audio = document.createElement('audio');
      audio.controls = true;
      audio.src = path;

      const dl = document.createElement('a');
      dl.href = path;
      dl.download = filename;
      dl.textContent = 'Download';
      dl.className = 'download-btn';

      div.appendChild(audio);
      div.appendChild(dl);

    } else if (lower.endsWith('.jpg') || lower.endsWith('.png') ||
               lower.endsWith('.jpeg') || lower.endsWith('.webp')) {
      const img = document.createElement('img');
      img.src = path;
      div.appendChild(img);
    }

    wrap.appendChild(div);
  });
}

// Extract real YouTube ID from ANY valid URL
function extractYouTubeId(url) {
  const reg = /(?:v=|\.be\/|embed\/)([A-Za-z0-9_-]{11})/;
  const match = url.match(reg);
  return match ? match[1] : null;
}


fetch('music.json')
  .then(r => r.json())
  .then(data => {
    window.musicData = data;
    populateArtists(data);
  })
  .catch(err => console.error('Failed to load JSON', err));
</script>

</body>
</html>
